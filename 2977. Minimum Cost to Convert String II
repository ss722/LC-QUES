class Solution {
public:
    long long INF = 1e18;
    unordered_map<string,int> mp;
    int n;
    long long solve(int i,string &source, string &target,vector<vector<long long>> &dist,vector<long long> &dp){
        if(i==n) return 0;
        if(dp[i]!=-1) return dp[i];

        long long ans = INF;
        
        // Same element
        if(source[i]==target[i]){
            ans = min(ans,0+solve(i+1,source,target,dist,dp));
        }

        // Other cases (Same + diff) 
        for(auto &p1:mp){
            const string &s1 = p1.first;
            int ind1 = p1.second;
            int len1 = s1.size();

            if( i+len1 > n ) continue;
            if(source.compare(i,len1,s1) !=0) continue;

            for(auto &p2:mp){
                const string &s2 = p2.first;
                int ind2 = p2.second;
                int len2 = s2.size();
                if(len1!=len2)continue;
                if(dist[ind1][ind2] == INF) continue;
                if(target.compare(i,len2,s2) !=0) continue;

                ans = min(ans,dist[ind1][ind2] + solve(i+len2,source,target,dist,dp));
            }
        }
        return dp[i] = ans;
    }
    long long minimumCost(string source, string target, vector<string>& original, vector<string>& changed, vector<int>& cost) {
        int cnt  =0;
        n=source.size();
        for(int i=0;i<original.size();i++){
            if(mp.count(original[i])==0) mp[original[i]] = cnt++;
            if(mp.count(changed[i])==0) mp[changed[i]] = cnt++;
        }
        vector<vector<long long>> dist(cnt,vector<long long>(cnt,INF));

        for (int i = 0; i < cnt; i++) dist[i][i] = 0;
        for(int i=0;i<original.size();i++){
            int u = mp[original[i]];
            int v = mp[changed[i]];
            dist[u][v] = min(dist[u][v],(long long)cost[i]);
        }
        
        // Floyyd warshal -> Linking add kr dega
        for(int stop=0;stop<cnt;stop++){
            for(int i=0;i<cnt;i++){
                for(int j=0;j<cnt;j++){
                    if(dist[i][stop]==INF || dist[stop][j]==INF)continue;
                    dist[i][j] = min(dist[i][j],dist[i][stop]+dist[stop][j]);
                }
            }
        }
        vector<long long> dp(n,-1);
        long long ans = solve(0,source,target,dist,dp);
        if(ans>=INF) return -1;
        return ans;
    }
};
